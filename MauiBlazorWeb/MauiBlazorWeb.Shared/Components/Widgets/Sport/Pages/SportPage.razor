@page "/sports/id={AccountDoesId:int}"
@inherits SportCompBase

@using Bases
@using MauiBlazorWeb.Shared.Components.Dialogs
@using Models.Sports

@if (!_appState.IsLoggedIn)
{
	<NotLoggedIn/>
}
else
{
	<div class="row">
		<div class="col-auto">
			<div class="row">
				<SportsCalendar AccountDoesId="AccountDoesId" />
			</div>
			<div class="row">
				<SportsCalendar AccountDoesId="AccountDoesId" />
			</div>
		</div>
		<div class="col">

		</div>
	</div>
}

@code {
	[Parameter, EditorRequired]
	public int AccountDoesId { get; set; }
	private Account_does_Sport accountDoesSport;

	public SportPage()
	{
		accountDoesSport = new Account_does_Sport();
	}

	protected override async Task ValidateParameters()
	{
		await base.ValidateParameters();
		accountDoesSport = ValidateAccountDoesSport(AccountDoesId);
	}

	protected override async Task OnAfterRenderAsync(bool firstRender)
	{
		await base.OnAfterRenderAsync(firstRender);
		if (firstRender)
		{
			var sport = allSports.FirstOrDefault(s => s.Id == accountDoesSport.Sport_Id);
			if (sport != null)
			{
				await InvokeAsync(() => _appState.Title = sport.Name);
				await InvokeAsync(() => _appState.MainLayout.RerenderLayout());
			}
		}
	}
}