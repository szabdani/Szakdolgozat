@inherits LayoutComponentBase
@using Blazored.LocalStorage
@using Models

@inject NavigationManager Navigation
@inject ILocalStorageService localStorage

<div class="page">
    <div class="sidebar">
        <NavMenu />
    </div>

    <main>
        <div class="top-row px-4 border-bottom">
        </div>
        <CascadingValue Value="UpdateTitle">
            <div class="px-4 py-3 border-bottom h3" style="background-color: #d6abab">
                @Title
            </div>
                <article class="content px-4">
                    <CustomErrorBoundary @ref="customErrorBoundary">
                        @Body
                    </CustomErrorBoundary>
                </article>
        </CascadingValue>
    </main>
    <div class="footer">
        <Footer />
    </div>
</div>


@code {
    public string? Title { get; set; }
    public Action<string>? UpdateTitle { get; set; }

    protected override void OnInitialized()
    {
        UpdateTitle = (string newTitle) =>
        {
            Title = newTitle;
            InvokeAsync(StateHasChanged);
        };
    }

    CustomErrorBoundary? customErrorBoundary;

    protected override void OnParametersSet()
    {
        customErrorBoundary?.ClearError();
    }
}